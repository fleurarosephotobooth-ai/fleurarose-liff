<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>Fleurarose Booking</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<style>
body{font-family:sans-serif;background:#f5f5f5;margin:0}
.wrap{max-width:600px;margin:auto;padding:20px}
.card{background:#fff;border-radius:16px;padding:20px}
input,select,textarea,button{
  width:100%;margin-top:10px;padding:12px;
  border-radius:10px;border:1px solid #ccc;font-size:16px
}
button{background:#111;color:#fff;border:none}
.msg{margin-top:12px}
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <h2>จองคิว Fleurarose</h2>
    <div id="hello"></div>

    <input id="name" placeholder="ชื่อ-นามสกุล">
    <input id="phone" placeholder="เบอร์โทร">

    <input id="date" type="date">

    <select id="slot">
      <option value="AM">เช้า 10:00–14:00</option>
      <option value="PM">เย็น 18:00–22:00</option>
    </select>

    <select id="job">
      <option>Photobooth</option>
      <option>Automate</option>
      <option>Telephone booth สีฟ้าขาว 1</option>
      <option>Telephone booth สีฟ้าขาว 2</option>
      <option>Telephone booth สีน้ำตาล</option>
    </select>

    <input id="location" placeholder="สถานที่">
    <textarea id="notes" placeholder="หมายเหตุ"></textarea>

    <button onclick="submitBooking()">ส่งคำขอจอง</button>
    <button onclick="contactAdmin()">ติดต่อแอดมิน</button>

    <div class="msg" id="msg"></div>
  </div>
</div>

<script>
const LIFF_ID = "2008882886-ubJheqfN";
const GAS_URL = "https://script.google.com/macros/s/AKfycbxsQpFCHld0vVim-VJcKg58Rf8ZKQevL73_Q3993kkbZiuKOq-IXMM3UR1xO-1i1LSl/exec";

let profile = null;

async function init() {
  await liff.init({ liffId: LIFF_ID });
  if (!liff.isLoggedIn()) liff.login();
  profile = await liff.getProfile();
  document.getElementById("hello").innerText =
    "สวัสดี " + profile.displayName;
}

async function submitBooking() {
  const payload = {
    line_user_id: profile.userId,
    line_display_name: profile.displayName,
    customer_name: name.value,
    phone: phone.value,
    event_date: date.value,
    time_slot: slot.value,
    job_type: job.value,
    location: location.value,
    notes: notes.value
  };

  const res = await fetch(GAS_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  const data = await res.json();
  msg.innerText = data.ok
    ? "ส่งคำขอจองเรียบร้อยแล้ว ✅"
    : "เกิดข้อผิดพลาด: " + data.error;
}

function contactAdmin() {
  liff.openWindow({
    url: "https://line.me/R/ti/p/@262clszf",
    external: true
  });
}

init();
</script>
</body>
</html>
